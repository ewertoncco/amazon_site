<!-- Wappler include head-page="layouts/dashboard" fontawesome_5="cdn" bootstrap5="custom" is="dmx-app" id="compras" appConnect="local" components="{dmxFormatter:{}}" -->
<dmx-serverconnect id="sc_compras" url="/api/usuarios/meus_itens"></dmx-serverconnect>
<meta name="ac:route" content="/compras">

<div class=" py-4 h-100 container">
    <!-- Header -->
    <div class="text-center mb-4">
        <h1 class="h3 mb-3">Compras</h1>
        <p class="text-muted">Todos os seus ingressos disponíveis</p>
    </div>

    <!-- Ticket List -->
    <div class="card-body pt-2">
        <div class="table-responsive">
            <table class="table table-hover m-0 table-actions-bar">

                <tbody is="dmx-repeat" id="compras" dmx-bind:repeat="sc_compras.data.vendas.data" key="id">
                    <tr>
                        <td class="mt-1 mb-1">
                            <img src="/assets/uploads/banners_eventos/8a82b8f2-d8f0-426f-9bc7-b9e4898e90bf.png" alt="contact-img" title="contact-img" class="avatar-sm" dmx-bind:src="evento_banner_principal">
                        </td>

                        <td>
                            <h5 class="fw-medium mt-0 mb-1 ms-0 me-0">{{produto_nome}}</h5>
                            <h5 class="m-0 fw-medium text-muted">{{evento_nome}}</h5>
                        </td>

                        <td><i class="mdi mdi-map-marker text-primary"></i> {{evento_local}}</td>

                        <td><i class="mdi mdi-clock-outline text-success"></i> {{evento_data_hora.formatDate("dd/MM/yyyy HH:mm")}}</td>

                        <td><i class="mdi mdi-ticket text-success"></i>{{data_resgate.isEmpty()}}</td>

                        <td class="text-center" dmx-hide="data_resgate.isDefined()">
                            <button id="btn2" class="btn">
                                <i class="fas fa-pen fa-lg"></i>
                            </button>
                        </td>
                        <td class="text-center">
                            <button id="btn1" class="btn" dmx-on:click="browser1.goto('/ingresso/'+id)">
                                <i class="fas fa-chevron-right fa-lg"></i></button>
                        </td>
                    </tr>



                </tbody>
            </table>
        </div>
    </div>

    <!-- Empty State (hidden when there are tickets) -->
    <div class="text-center py-5 d-none">
        <div class="mb-4">
            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" class="bi bi-ticket-perforated text-muted" viewBox="0 0 16 16">
                <path d="M4 4.85v.9h1v-.9H4Zm7 0v.9h1v-.9h-1Zm-7 1.8v.9h1v-.9H4Zm7 0v.9h1v-.9h-1Zm-7 1.8v.9h1v-.9H4Zm7 0v.9h1v-.9h-1Zm-7 1.8v.9h1v-.9H4Zm7 0v.9h1v-.9h-1Z" />
                <path d="M1.5 3A1.5 1.5 0 0 0 0 4.5V6a.5.5 0 0 0 .5.5 1.5 1.5 0 1 1 0 3 .5.5 0 0 0-.5.5v1.5A1.5 1.5 0 0 0 1.5 13h13a1.5 1.5 0 0 0 1.5-1.5V10a.5.5 0 0 0-.5-.5 1.5 1.5 0 0 1 0-3A.5.5 0 0 0 16 6V4.5A1.5 1.5 0 0 0 14.5 3h-13ZM1 4.5a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 .5.5v1.05a2.5 2.5 0 0 0 0 4.9v1.05a.5.5 0 0 1-.5.5h-13a.5.5 0 0 1-.5-.5v-1.05a2.5 2.5 0 0 0 0-4.9V4.5Z" />
            </svg>
        </div>
        <h3 class="h5 mb-3">Nenhum ingresso encontrado</h3>
        <p class="text-muted">Você ainda não possui ingressos comprados.</p>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>